version: 1
targets:
  - name: niri
    format: kdl
    output: ~/.config/niri/config.test.kdl
    sources:
      - path: ~/.config/niri/dms/colors.kdl
      - path: ~/.config/niri/src/*.kdl
        sort: lex
      - path: ~/.config/niri/testtest.kdl
        optional: true
    merge:
      rules:
        keys: last_wins
        section_keys: ["layout"]
  - name: test_yaml
    format: yaml
    output: ../testdata/merged.yaml
    sources:
      - path: ../testdata/base.yaml
      - path: ../testdata/overlay.yaml
    merge:
      rules:
        maps: deep
        arrays: unique_append
  - name: test_toml
    format: toml
    output: ../testdata/merged.toml
    sources:
      - path: ../testdata/toml/base.toml
      - path: ../testdata/toml/overlay.toml
    merge:
      rules:
        maps: deep
        arrays: unique_append
  - name: test_ini
    format: ini
    output: ../testdata/merged.ini
    sources:
      - path: ../testdata/ini/base.ini
      - path: ../testdata/ini/overlay.ini
    merge:
      rules:
        repeated_keys: last_wins

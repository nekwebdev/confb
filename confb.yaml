version: 1
targets:
  - name: niri
    format: kdl
    output: ~/.config/niri/config.test.kdl
    sources:
      - path: ~/.config/niri/dms/colors.kdl
      - path: ~/.config/niri/src/*.kdl
        sort: lex
      - path: ~/.config/niri/testtest.kdl
        optional: true
    merge:
      rules:
        key: last_wins
        section_keys: ["layout"]
  - name: test_yaml
    format: yaml
    output: ../testdata/merged.yaml
    sources:
      - path: ../testdata/base.yaml
      - path: ../testdata/overlay.yaml
    merge:
      rules:
        maps: deep
        arrays: unique_append
